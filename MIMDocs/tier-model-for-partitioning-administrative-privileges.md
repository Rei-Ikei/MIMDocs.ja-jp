---
タイトル: 管理者特権をパーティション分割を層モデル
ms.custom: na
ms.prod: identity manager 2015
ms.reviewer: na
ms.service: active directory
ms.suite: na
ms.technology:
  - active directory ドメイン サービス
ms.tgt_pltfrm: na
ms.topic: 記事
ms.assetid: c6e3cd02-1e32-4194-a8ed-3a0b3d022a43
作成者: Kgremban
---
# 管理者特権のパーティション分割の階層モデル
## はじめに

境界は今でも大規模な戦略の有効なコンポーネントですが、今日の脅威に直面した環境では、境界に重点を置く防御の効果は低下してきています。 この境界の効果が失われることにより、組織では侵害が既に発生していることを想定し、それに従ってコンピューティング リソースおよびビジネス リソースの防御を設計する必要があります。 規模が大きくても組織が管理できるようにするため、このドキュメントでは、(ベスト プラクティスとセキュリティの原則に従いながら) 優れたユーザー エクスペリエンスを実現する、特権の昇格からの保護を意図したセキュリティ モデルについて説明します。

ユーザーを決定するプロセスを簡略化の層に管理者特権をパーティション分割し、グループに含められるに適した、 [要塞環境](planning-bastion-environment.md)します。

## 背景: Active Directory フォレストにおける特権の昇格

Windows Server Active Directory フォレストに対して、永続的で完全な管理者特権を与えられているユーザー、サービス、またはアプリケーション アカウントにより、組織の任務と業務に多大なリスクが発生します。 これらのアカウントは攻撃者のターゲットとされることがあり、侵害されると、攻撃者は多くの場合、ただちにドメイン内の他の任意のサーバーやアプリケーションに接続する権限を持つことになります。

展開によっては、アカウント オペレーターおよびサーバー オペレーターが、これらのロールで効果的に制御可能なアカウント、サーバー、およびアプリケーションを介して、有効で完全な管理者となるように、ドメインが構成されている場合もあります。 ほとんどの場合、これらの構成は、ドメイン内のすべてのクライアントやサーバー、またはドメイン内のすべてのユーザーやコンピューター アカウントに対して、管理者権限を行使するというアプリケーションのニーズをサポートするように行われています。 さらに、これらの両方の種類の権利を必要とするアプリケーションはほとんどないため、両方に対してディレクトリ管理者の権利を付与すると、攻撃者や悪意のある内部関係者に利点のある過剰なアクセス許可の状態を生み出します。

## 特権の昇格を抑制するための階層モデル

次のガイダンスでは、既存のリソースを速やかに分類し、アカウントの利用を制限するゾーンを設定するための簡単なモデルについて説明します。 このモデルは、管理機能に Biba および Bell-LaPadulala 階層モデルを採用しており、管理者特権の 3 つの階層 (およびドメイン規模の管理者ではないエンド ユーザーの階層) で表されます。 管理者のアクセス権を適切にパーティション分割し、管理するため、アカウントおよびアプリケーションをそれらの機能に応じて、組織の運用と任務に影響する 4 つの特権階層のいずれかに分類します。

- **階層 0:** フォレスト管理者 - Active Directory フォレスト、ドメイン、またはドメイン コント ローラーの直接または間接的管理機能

- **階層 1:** サーバー管理者 - 単一または複数のサーバーの直接または間接的管理機能

- **階層 2:** ワークステーション管理者 - 複数のデバイスの直接または間接的管理機能

- **階層 3:** ユーザー - 単一のデバイスの権限のないユーザーまたは管理機能

特定のビジネス ニーズで、その他の階層や追加のセグメンテーションが必要になる場合もありますが、このモデルは開始点として使用できます。

![pam 階層](./media/pam-tiers.png)

### 階層化された権限モデルのガイドライン

モデルは、盗んだ資格情報を使用した攻撃者の特権パスの昇格を妨げることを目的としており、次のルールによって定義されます。

1. 管理対象のすべてのリソース (グループ、アカウント、サーバー、ワークステーション、Active Directory オブジェクト、またはアプリケーション) を厳密に 1 つの階層に分類し、資格情報の盗難技術を使用する攻撃者の特権パスの昇格を防ぎます。

2. 複数の階層にあるリソースにログインし、管理する責任を持つユーザーは、必要な階層ごとに作成された個別の管理者アカウントを持つことになります。 現在複数のカテゴリにログインしているアカウントは、それぞれ 1 つだけの階層定義内に収まる複数のアカウントに分割されます。 これらのアカウントでは、異なるパスワードを使用する必要もあります。

3. 管理者アカウントは、アクセス制御リスト (ACL)、アプリケーション エージェント、またはサービス アカウントの制御などの管理アクセスによって、上位の階層のリソースを制御することはできません。 上位の階層を制御するアカウントは、下位の階層のコンピューターにログインできません。それらのコンピューターにログインすることで、そのアカウントに割り当てられているアカウントの資格情報や特権が公開され、それらの制御が誤って付与される可能性があるためです。 一部の特定の例外では、制限付き管理モードで RDP を使用して、資格情報を公開せずに、リモート デスクトップを使用できます。

4. 管理者アカウントは、各自のロールで必要に応じて下位の階層のリソースを制御できます。ただし、これは上位の階層にあり、資格情報を公開しない管理インターフェイスを経由した場合に限ります。たとえば、ドメイン管理者アカウント (階層 0) は、ドメイン コントローラー上の Active Directory 管理コンソール (階層 0) 経由で、サーバー管理者 Active Directory アカウント オブジェクト (階層 1) を管理します。

5. コンピューター アカウントを含む各組織単位 (OU) には、その特定の階層のコンピューター アカウントのみを含めることができます。 OU に複数の階層のコンピューター アカウントが含まれる場合、1 つの階層のコンピューター アカウントは別のドメインに移行され、それぞれ個々の階層を格納する OU や個別のサブ OU が作成されます。

### 階層 0 - ドメイン/フォレスト管理者

この階層内のグループ、アカウント、ドメイン コントローラー、特別な Active Directory オブジェクト、およびアプリケーションを制御するすべてのユーザーは、ドメインまたはフォレスト内の任意の場所で任意のコードを実行する権限を持ちます。 階層 0 のスコープは、単一の Active Directory ドメインに関連しますが、一部のアカウントやその他の要素で複数のドメインに階層 0 の影響が及ぶことがあります。 階層 0 には次が含まれます。

#### サーバーとワークステーション

- ドメイン コントローラー
- ドメイン コントローラー上のエージェントを制御する管理アプリケーションをホストするサーバー
- 階層 0 の資格情報が公開されるサーバーやワークステーションを含む、階層 0 のアカウントがログインするサーバーやワークステーション (階層 0 のサーバーでサービスを実行する同じアカウント資格情報でサービスを実行しているか、または階層 0 のサーバーを管理するために使用されるサーバーやワークステーション)

#### Active Directory オブジェクト

- 各ドメインのシステム コンテナー内の AdminSDHolder オブジェクト
- ドメインの名前付けコンテキストでのシステム コンテナー
- ドメイン コントローラー OU
- 階層 0 のオブジェクトを含む OU (親 OU を含む)
- 階層 0 の OU にリンクされているグループ ポリシー

#### Active Directory グループ
- あらかじめ登録された、定義済みの AD グループと、次を含むグループのメンバー:
  - Domain Admins
  - Enterprise Admins
  - Schema Admins
  - Builtin\\Administrators
  - Account Operators
  - Backup Operators

- 次を含む階層 0 のグループ (上記) と同等のアクセス許可が委任されたグループ:
  - Active Directory 内のすべてまたはほとんどすべてのオブジェクトを変更する権限
  - 任意の階層 0 のアカウントのパスワードをリセットする権限
  - 他の階層 0 のオブジェクト (ユーザー、グループ、コンピューター、OU、グループ ポリシー、または特殊オブジェクト) の変更またはフル コントロール権限が付与されたグループ

#### アカウント
- あらかじめ登録された Administrator アカウント
- 階層 0 のグループのメンバーであるアカウント
- 階層 0 のオブジェクトへの書き込み、またはフル コントロール権限を持つアカウント
- 階層 0 のグループ (階層 0 グループ内の上記の権限を含む) と同等のアクセス許可が委任されたアカウント
- 階層 0 のアプリケーションへの管理者権限を持つアカウント

#### アプリケーション
- ドメイン コントローラーで、サービスとして実行しているアプリケーション
- ドメイン コントローラーでエージェントを制御するアプリケーション

#### ハードウェアとデバイス
- 階層 0 のシステムが実行しているハードウェア (ドメイン コント ローラーにシールドされた VM が展開されているかどうかよって異なることに注意してください)
- ドメイン コントローラー、同様のシステム、およびバックアップの物理ハードウェアへのアクセス権を持つすべてのユーザー
- 階層 0 の仮想化コンピューターがホストされている仮想マシン ホストへの管理アクセス権を持つすべてのユーザー
- 階層 0 の資格情報が入力されたか、保存されたデバイス (リモート アクセスに使用されるモバイル デバイなど)

### 階層 1 – サーバーおよびアプリケーション管理者

運用 Active Directory ドメイン環境で、ドメイン コントローラー以外のサーバーを制御するすべてのユーザーと、それらのユーザーの管理グループおよびアカウントは、それらのサーバー上の任意の場所で任意のコードを実行する権限を持ちます。 階層 1 のスコープは、単一の Active Directory ドメインに関連します。 階層 1 のリソースには、次の条件を満たす (および階層 0 として分類されない) すべてのリソースが含まれます。

#### サーバーとワークステーション
- ドメインに参加しているサーバー
- 階層 1 の資格情報が公開されるワークステーションを含む、階層 1 のアカウントがログインするワークステーション (階層 1 のサーバーでサービスを実行する同じアカウント資格情報でサービスを実行しているか、または階層 1 のサーバーを管理するために使用されるワークステーション)

#### Active Directory オブジェクト
- 階層 1 のオブジェクトを含む OU
- 階層 1 の OU にリンクされているグループ ポリシー

#### Active Directory グループ
- Server Operators グループ (またはそのメンバーのグループ)
- メンバーに階層 1 のオブジェクトへの書き込みまたはフル コントロール権限が付与されているグループ、または階層 1 のオブジェクト (ユーザー、グループ、コンピューター、OU、またはグループ ポリシー オブジェクト) への変更またはフル コントロール権限を付与されたグループ

#### アカウント
- 階層 1 のグループのメンバーであるアカウント
- 階層 1 のグループと同等のアクセス許可 (階層 1 のグループ内の上記の権限を含む) が委任されたアカウントを含む、他の任意の階層 1 のオブジェクトへの書き込みまたはフル コントロール権限を持つアカウント (ヘルプデスク アカウントなど)
- 1 つまたは複数のサーバー上のローカル管理者グループのメンバーであるアカウント
- 階層 1 のアプリケーションの管理者権限を持つアカウント

#### アプリケーション
- 階層 1 のサーバーで、サービスとして実行しているアプリケーション
- 階層 1 のサーバーでエージェントを制御するアプリケーション

#### ハードウェアとデバイス
- 階層 1 のシステムが実行しているハードウェア
- サーバーの物理ハードウェアへのアクセス権を持つユーザー
- 階層 1 の仮想化コンピューターがホストされている仮想マシン ホストへの管理アクセス権を持つすべてのユーザー
- 階層 1 の資格情報が入力されたか、保存されたデバイス (リモート アクセスに使用されるモバイル デバイスなど)

### 階層 2 - ワークステーションおよびエンドユーザー管理者

運用 Active Directory ドメイン環境でワークステーションと標準ユーザーを制御するすべてのユーザーは、それらのワークステーション上の任意の場所またはそれらのユーザーとして、任意のコードを実行する権限を持ちます。 階層 2 のスコープは、単一の active directory ドメインに関連します。 階層 2 のリソースには、次の条件を満たす (および階層 0 または階層 1 として分類されない) すべてのリソースが含まれます。

#### ［ワークステーション］
- 任意のユーザーがログオンできる (階層 1 または階層 0 のアカウントによって使用される管理ワークステーションを除く) 環境内のワークステーション

#### Active Directory オブジェクト
 - 階層 2 のオブジェクトを含む OU
 - 階層 2 にリンクされているグループ ポリシー

#### Active Directory グループ
- 階層 2 または階層 3 のオブジェクト (ユーザー、グループ、コンピューター、OU、またはグループ ポリシー オブジェクト) への変更またはフル コントロール権限が付与されたグループ
- 1 つまたは複数のワークステーション上のローカル管理者グループのメンバーであるグループ (ヘルプ デスク管理者や他の PC およびエンド ユーザー サポート グループなど)。

#### アカウント
- 階層 2 のグループのメンバーであるアカウント
- 1 つまたは複数のワークステーション上のローカル管理者グループのメンバーであるアカウント

> [!メモ] {これが含まれますすべてのエンドユーザーが各自のワークステーション上の管理者権限が与えられる場合です。}

- 他の階層 2 のオブジェクトへの書き込みまたはフル コントロール権限を持つアカウント
- 階層 2 のアプリケーションの管理者権限を持つアカウント

#### アプリケーション
- ワークステーションでサービスとして実行しているアプリケーション
- ワークステーションでエージェントを制御するアプリケーション

#### ハードウェアとデバイス
- 階層 2 のシステムが実行しているハードウェア
- ワークステーションの物理ハードウェアへのアクセス権を持つユーザー
- 階層 2 の仮想化コンピューターがホストされている仮想マシン ホストへの管理者アクセス権を持つユーザー
- 階層 2 の資格情報が入力されたか、保存されたデバイス (リモート アクセスに使用されるモバイル デバイスなど)

### 階層 3 - 標準ユーザー

この階層は、ドメイン内の複数のコンピューターへの管理者権限を持たない標準のユーザーを記述します。

## ログオン制限による資格情報の公開の制限

管理者アカウントの資格情報の盗難のリスクを抑えるには、一般に管理作業を作り直して、攻撃者への公開を制限する必要があります。 最初の手順として、組織は次を実行することをお勧めします。

- 管理者の資格情報が公開されるホストの数を制限する。
- ロールの権限を最低限必要なものに制限する。
- 標準ユーザーのアクティビティ (電子メールや Web 閲覧など) に使用されるホストで、管理タスクが実行されないようにする。

次の手順は、ログオン制限を実装し、プロセスと作業が階層モデル要件を遵守できるようにすることです。 理想的には、資格情報の公開を各階層内のロールに最低限必要な権限に縮小する必要もあります。

ログオン制限を適用し、次を確実にする必要があります。

- ドメイン管理者 (階層 0) は、エンタープライズ サーバー (階層 1 ) と標準ユーザー ワークステーション (階層 2) にログオンできません。
- サーバー管理者 (階層 1) は、標準ユーザー ワークステーション (階層 2) にログオンできません。

>[注]{サーバー管理者はドメイン管理者グループに属していてはなりません。 ドメイン コントローラーとエンタープライズ サーバーの両方を管理する責任を負うユーザーには、個別のアカウントが付与される必要があります。}

ログオン制限は次によって適用することができます。

- [ネットワーク経由でコンピュータへアクセスを拒否する]、[バッチ ジョブとしてログオンを拒否する]、[サービスとしてログオンを拒否する]、[ローカルでログオンを拒否する]、[リモートデスクトップサービスを使ったログオンを拒否する] を含むグループ ポリシー ログオン権限の制限
- Windows Server 2012 以降を使用している場合は、認証ポリシーとサイロ
- アカウントが専用管理者フォレスト内にある場合、認証の選択

次のドキュメント [要塞環境の計画](planning-bastion-environment.md), 、専用管理フォレスト管理者のアカウントを確立するために Microsoft Identity Manager 用に追加する方法について説明します。


<!--HONumber=Mar16_HO1-->


